#!/bin/sh
# Puppet: <%= @title %>
# This script is a wrapper of accesible hooks, defined via hiera and accessed
# via ssh with the ForceCommand option.

set -- $SSH_ORIGINAL_COMMAND
command="$1"; shift
case "$command" in
    <%- @hooks.each do |hook, values| -%>
    <%= hook %>)
        /home/<%= @deploy_user %>/bin/<%= hook %> "$@"
        ;;
    <%- end -%>
    *)
        echo "Sorry. Only these commands are available to you:"
        <%- @hooks.keys do |value| -%>
        echo <%= value %>
        <%- end -%>
        exit 1
        ;;
esac
